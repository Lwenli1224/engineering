<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="738px" height="661px" version="1.1" style="background-color: rgb(255, 255, 255);"><defs/><g transform="translate(0.5,0.5)"><rect x="148" y="148" width="120" height="60" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(150,172)"><switch><foreignObject pointer-events="all" width="116" height="13" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">_read()</div></foreignObject><text x="58" y="12" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">[Object]</text></switch></g><rect x="149" y="372" width="120" height="60" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(151,396)"><switch><foreignObject pointer-events="all" width="116" height="13" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">ret = fromList(m)</div></foreignObject><text x="58" y="12" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">[Object]</text></switch></g><path d="M 208 208 L 208 237 Q 208 247 198 247 L 128 247" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 123 247 L 130 243 L 128 247 L 130 250 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="272" y="536" width="120" height="60" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(274,560)"><switch><foreignObject pointer-events="all" width="116" height="13" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">emit('data', ret)</div></foreignObject><text x="58" y="12" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">[Object]</text></switch></g><path d="M 402 347 L 402 324 L 602 324 L 602 347 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 402 347 L 402 481 L 602 481 L 602 347" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(404,329)"><switch><foreignObject pointer-events="all" width="196" height="13" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 196px; white-space: normal; font-weight: bold; text-align: center;">state</div></foreignObject><text x="98" y="12" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica" font-weight="bold">[Object]</text></switch></g><rect x="405" y="352" width="97" height="110" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" font-size="12px"><text x="407" y="370">flowing</text><text x="407" y="384">buffer</text><text x="407" y="398">needReadable</text><text x="407" y="412">length</text><text x="407" y="426">reading</text><text x="407" y="440">sync</text></g><rect x="512" y="352" width="83" height="110" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-size="12px"><text x="514" y="370">: Boolean</text><text x="514" y="384">: Array</text><text x="514" y="398">: Boolean</text><text x="514" y="412">: Number</text><text x="514" y="426">: Boolean</text><text x="514" y="440">: Boolean</text></g><path d="M 676 317 L 676 392 Q 676 402 666 402 L 608 402" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 603 402 L 610 399 L 608 402 L 610 406 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 269 402 L 395 402" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 400 402 L 393 406 L 395 402 L 393 399 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="280" y="396" width="112" height="14" stroke-width="0"/><text x="335" y="399">从state.buffer中取数据</text></g><path d="M 209 468 L 249 508 L 209 548 L 169 508 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(171,502)"><switch><foreignObject pointer-events="all" width="76" height="13" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 76px; white-space: normal; text-align: center;">ret = null?</div></foreignObject><text x="38" y="12" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">[Object]</text></switch></g><path d="M 209 432 L 209 462" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 209 467 L 206 460 L 209 462 L 213 460 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 249 508 L 322 508 Q 332 508 332 518 L 332 530" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 332 535 L 329 528 L 332 530 L 336 528 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="300" y="502" width="10" height="14" stroke-width="0"/><text x="305" y="512">N</text></g><path d="M 62 88 L 102 128 L 62 168 L 22 128 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(24,122)"><switch><foreignObject pointer-events="all" width="76" height="13" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 76px; white-space: normal; text-align: center;">doRead?</div></foreignObject><text x="38" y="12" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">[Object]</text></switch></g><path d="M 62 168 L 62 210" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 62 215 L 59 208 L 62 210 L 66 208 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="58" y="186" width="10" height="14" stroke-width="0"/><text x="62" y="196">N</text></g><path d="M 102 128 L 198 128 Q 208 128 208 135 L 208 142" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 208 147 L 205 140 L 208 142 L 212 140 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="161" y="122" width="9" height="14" stroke-width="0"/><text x="165" y="132">Y</text></g><ellipse cx="62" cy="32" rx="30" ry="30" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(34,26)"><switch><foreignObject pointer-events="all" width="56" height="13" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 56px; white-space: normal; text-align: center;">read(n)</div></foreignObject><text x="28" y="12" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">[Object]</text></switch></g><ellipse cx="62" cy="629" rx="30" ry="30" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(34,623)"><switch><foreignObject pointer-events="all" width="56" height="13" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 56px; white-space: normal; text-align: center;">return ret</div></foreignObject><text x="28" y="12" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">[Object]</text></switch></g><path d="M 332 596 L 332 619 Q 332 629 322 629 L 98 629" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 93 629 L 100 626 L 98 629 L 100 633 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 62 62 L 62 82" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 62 87 L 59 80 L 62 82 L 66 80 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="2" y="217" width="120" height="60" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(4,240)"><switch><foreignObject pointer-events="all" width="116" height="13" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal;">m=howMuchToRead(n)</div></foreignObject><text x="58" y="12" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">[Object]</text></switch></g><path d="M 62 312 L 102 352 L 62 392 L 22 352 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(24,346)"><switch><foreignObject pointer-events="all" width="76" height="13" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 76px; white-space: normal; text-align: center;">m &gt; 0?</div></foreignObject><text x="38" y="12" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">[Object]</text></switch></g><path d="M 62 277 L 62 306" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 62 311 L 59 304 L 62 306 L 66 304 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 102 352 L 199 352 Q 209 352 209 359 L 209 366" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 209 371 L 206 364 L 209 366 L 213 364 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="162" y="346" width="9" height="14" stroke-width="0"/><text x="166" y="356">Y</text></g><path d="M 62 537 L 62 593" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 62 598 L 59 591 L 62 593 L 66 591 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="2" y="477" width="120" height="60" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(4,501)"><switch><foreignObject pointer-events="all" width="116" height="13" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">ret = null</div></foreignObject><text x="58" y="12" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">[Object]</text></switch></g><path d="M 62 392 L 62 471" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 62 476 L 59 469 L 62 471 L 66 469 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="58" y="429" width="10" height="14" stroke-width="0"/><text x="62" y="438">N</text></g><path d="M 676 138 L 716 178 L 676 218 L 636 178 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(638,172)"><switch><foreignObject pointer-events="all" width="76" height="13" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 76px; white-space: normal; text-align: center;">立即输出?</div></foreignObject><text x="38" y="12" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">[Object]</text></switch></g><path d="M 601 178 L 630 178" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 635 178 L 628 182 L 630 178 L 628 175 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="616" y="33" width="120" height="60" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(618,57)"><switch><foreignObject pointer-events="all" width="116" height="13" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">emit('data', chunk)</div></foreignObject><text x="58" y="12" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">[Object]</text></switch></g><path d="M 676 138 L 676 99" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 676 94 L 680 101 L 676 99 L 673 101 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="672" y="110" width="9" height="14" stroke-width="0"/><text x="676" y="119">Y</text></g><rect x="616" y="257" width="120" height="60" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(618,280)"><switch><foreignObject pointer-events="all" width="116" height="13" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">state.buffer.push(chunk)</div></foreignObject><text x="58" y="12" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">[Object]</text></switch></g><path d="M 676 218 L 676 250" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 676 255 L 673 248 L 676 250 L 680 248 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="672" y="231" width="10" height="14" stroke-width="0"/><text x="676" y="241">N</text></g><ellipse cx="415" cy="178" rx="30" ry="30" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(387,172)"><switch><foreignObject pointer-events="all" width="56" height="13" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 56px; white-space: normal; text-align: center;">push(data)</div></foreignObject><text x="28" y="12" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">[Object]</text></switch></g><path d="M 268 178 L 379 178" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 384 178 L 377 182 L 379 178 L 377 175 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="288" y="172" width="79" height="14" stroke-width="0"/><text x="327" y="175">同步或异步调用</text></g><path d="M 209 548 Q 209 578 181 588 Q 152 598 90 607" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 84 608 L 91 603 L 90 607 L 92 610 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="158" y="589" width="9" height="14" stroke-width="0"/><text x="162" y="598">Y</text></g><rect x="481" y="148" width="120" height="60" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(483,172)"><switch><foreignObject pointer-events="all" width="116" height="13" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">chunk = decode(data)</div></foreignObject><text x="58" y="12" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">[Object]</text></switch></g><path d="M 445 178 L 475 178" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 480 178 L 473 182 L 475 178 L 473 175 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/></g></svg>